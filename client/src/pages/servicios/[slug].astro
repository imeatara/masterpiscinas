---
import Layout from "../../layouts/Layout.astro";
import services from "../../data/services";
import { Image } from "astro:assets";

// Genera todas las rutas en build
export async function getStaticPaths() {
  return services.map((s) => ({
    params: { slug: s.slug },
    props: { service: s },
  }));
}

// Recibe el servicio como prop
const { service } = Astro.props;

const WSP = "5492644822296";
const wspHref = `https://wa.me/${WSP}?text=${encodeURIComponent(
  `Hola! Quiero solicitar el servicio de ${service.title}`
)}`;

const breadcrumbs = [
  { name: "Inicio", url: "/" },
  { name: service.title, url: `/servicios/${service.slug}` },
];

const faq = [
  {
    q: `¿Cada cuánto conviene pedir ${service.title.toLowerCase()}?`,
    a: "Recomendamos al menos una vez por temporada, o cuando notes manchas persistentes, algas o desgaste.",
  },
  {
    q: "¿Incluye los insumos y herramientas?",
    a: "Sí. Usamos productos y herramientas específicas según el tipo de pileta para asegurar un resultado duradero.",
  },
  {
    q: "¿Cuánto demora el servicio?",
    a: "Varía por tamaño y estado. En general, entre 2 y 6 horas. Te confirmamos en la visita previa.",
  },
];
---

<Layout title={service.title} description={service.desc}>
  <article class="space-y-10 mx-auto px-6 py-12 max-w-4xl">
    <!-- Breadcrumbs -->
    <nav>
      <ol class="flex flex-wrap gap-2 text-slate-500 text-sm">
        {
          breadcrumbs.map((b, i) => (
            <li class="inline-flex items-center gap-2">
              {i > 0 && <span>/</span>}
              {i < breadcrumbs.length - 1 ? (
                <a
                  href={b.url}
                  class="hover:text-slate-700 underline underline-offset-2"
                >
                  {b.name}
                </a>
              ) : (
                <span class="text-slate-700">{b.name}</span>
              )}
            </li>
          ))
        }
      </ol>
    </nav>

    <!-- Título + hero del servicio -->
    <header class="space-y-4">
      <h1 class="font-bold text-slate-900 text-3xl md:text-4xl">
        {service.title}
      </h1>
      <p class="text-slate-700 text-lg">{service.desc}</p>
    </header>

    <!-- Imagen principal -->
    <figure class="shadow rounded-xl ring-1 ring-slate-200/60 overflow-hidden">
      <Image
        src={service.src}
        alt={service.alt}
        width="1280"
        height="720"
        class="w-full h-auto object-cover"
        transition:name={`img-${service.slug}`}
      />
      {
        service.alt && (
          <figcaption class="px-4 py-2 text-slate-500 text-sm">
            {service.alt}
          </figcaption>
        )
      }
    </figure>

    <!-- ¿Qué incluye? -->
    <section class="space-y-4">
      <h2 class="font-semibold text-slate-900 text-2xl">
        ¿Qué incluye este servicio?
      </h2>
      <ul class="gap-3 grid">
        <li class="text-slate-700 leading-relaxed">
          Inspección previa de la pileta para evaluar el estado.
        </li>
        <li class="text-slate-700 leading-relaxed">
          Uso de productos y herramientas específicas para un resultado
          duradero.
        </li>
        <li class="text-slate-700 leading-relaxed">
          Trabajo realizado por personal capacitado con experiencia.
        </li>
        <li class="text-slate-700 leading-relaxed">
          Limpieza final y puesta a punto para que quede lista para usar.
        </li>
      </ul>
    </section>

    <!-- Beneficios -->
    <section class="space-y-4">
      <h2 class="font-semibold text-slate-900 text-2xl">Beneficios</h2>
      <p class="text-slate-700">
        Asegurás una pileta en óptimas condiciones, segura y estéticamente
        impecable. El mantenimiento adecuado prolonga la vida útil de los
        materiales y evita gastos mayores a futuro.
      </p>
    </section>

    <!-- Recomendaciones -->
    <section class="space-y-4">
      <h2 class="font-semibold text-slate-900 text-2xl">Recomendaciones</h2>
      <p class="text-slate-700">
        Realizalo al menos una vez por temporada o cuando notes manchas
        persistentes, algas o desgaste en la superficie.
      </p>
    </section>

    <!-- CTA -->
    <section class="space-y-4">
      <div
        class="flex md:flex-row flex-col justify-between items-start md:items-center gap-4 bg-gradient-to-r from-blue-700 to-blue-500 shadow p-6 md:p-8 rounded-2xl text-white"
      >
        <div>
          <p class="font-semibold text-lg">¿Querés este servicio?</p>
          <p class="text-blue-50">
            Escribinos por WhatsApp y coordinamos la visita.
          </p>
        </div>
        <div class="flex flex-wrap gap-3">
          <a
            href={wspHref}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex justify-center items-center bg-white hover:bg-blue-50 px-5 py-3 rounded-full font-semibold text-blue-700 transition"
          >
            Solicitar por WhatsApp
          </a>
          <a
            href={`mailto:masterpiscinas.sj@gmail.com?subject=${encodeURIComponent(
              "Consulta: " + service.title
            )}`}
            class="inline-flex justify-center items-center hover:bg-white/10 px-5 py-3 border border-white/80 rounded-full text-white transition"
          >
            Enviar correo
          </a>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section class="space-y-4">
      <h2 class="font-semibold text-slate-900 text-2xl">
        Preguntas frecuentes
      </h2>
      <dl class="space-y-3">
        {
          faq.map((item) => (
            <div class="space-y-1">
              <dt class="font-medium text-slate-900">{item.q}</dt>
              <dd class="text-slate-700">{item.a}</dd>
            </div>
          ))
        }
      </dl>
    </section>
  </article>
</Layout>
